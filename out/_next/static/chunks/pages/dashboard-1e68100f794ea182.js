(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[26],{528:function(e,t,r){(window.__NEXT_P=window.__NEXT_P||[]).push(["/dashboard",function(){return r(2543)}])},802:function(e,t,r){"use strict";r.d(t,{d:function(){return c},z:function(){return l}});var n=r(5893),a=r(7294),s=r(8426),i=r(2003),o=r(7537);let c=(0,i.j)("inline-flex items-center justify-center whitespace-nowrap rounded-md text-sm font-medium transition-colors focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:pointer-events-none disabled:opacity-50",{variants:{variant:{default:"bg-primary text-primary-foreground shadow hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground shadow-sm hover:bg-destructive/90",outline:"border border-input bg-transparent shadow-sm hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground shadow-sm hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-9 px-4 py-2",sm:"h-8 rounded-md px-3 text-xs",lg:"h-10 rounded-md px-8",icon:"h-9 w-9"}},defaultVariants:{variant:"default",size:"default"}}),l=a.forwardRef((e,t)=>{let{className:r,variant:a,size:i,asChild:l=!1,...d}=e,u=l?s.g7:"button";return(0,n.jsx)(u,{className:(0,o.cn)(c({variant:a,size:i,className:r})),ref:t,...d})});l.displayName="Button"},4334:function(e,t,r){"use strict";var n=r(9734),a=r(1473);t.Z=e=>{let{data:t,error:r}=(0,n.ZP)("/hardware-id",a.Od,{revalidateIfStale:!1,revalidateOnFocus:!1,revalidateOnReconnect:!1,...e});return{hwid:t,isLoading:!r&&!t,isError:r}}},1473:function(e,t,r){"use strict";r.d(t,{uT:function(){return f},Od:function(){return h},I_:function(){return x},GI:function(){return m},M7:function(){return g},sc:function(){return w},wl:function(){return p},Sj:function(){return v},b:function(){return y},Hu:function(){return b},Cz:function(){return j}});var n=r(9734),a=r(5752),s=r(7478),i=r(8893),o=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:void 0;return(0,s.H_)(async()=>{try{var r,n;if(!(null===(n=window.pywebview)||void 0===n?void 0:null===(r=n.api)||void 0===r?void 0:r[e]))throw Error("API endpoint not found");await (0,i.Z)("PyCall ".concat(e),t);let a=await window.pywebview.api[e](t).then(e=>JSON.parse(e)).then(async t=>{if(null==t?void 0:t.error)throw t.error;if(void 0===t.message)throw Error("Response message was empty ".concat(t));return await (0,i.Z)("Pycall ".concat(e," returned: ").concat(t.message),t),t.message});return a}catch(r){let t="".concat(r);throw r instanceof Error&&(t=r.message),await (0,i.Z)("Pycall ".concat(e," (retrying): ").concat(t)),Error(t)}},a.Z.RETRY_DELAY,a.Z.MAX_RETRIES).catch(async t=>{let r="".concat(e," - ").concat(t);throw t instanceof Error&&(r=t.message),await (0,i.Z)("Pycall ".concat(e," - FATAL ERROR: ").concat(r)),Error(r)})};let c=e=>o("get",{key:e}).then(e=>{console.log("Got: ",e);try{return JSON.parse(e)}catch(t){return e}}).catch(e=>(console.log("pyget error: ".concat(e)),"")),l=(e,t)=>(console.log("Setting: ".concat(e,", ").concat(t)),o("set",{key:e,data:t}).catch(e=>(console.log("Pyset error: ",e),""))),d=()=>o("deviceOn").catch(()=>"error"),u=()=>o("deviceOff").catch(()=>"error"),f=()=>o("getDeviceStatus").catch(()=>"error"),h=()=>o("getHardwareId").catch(()=>""),m=async()=>{let e=await (0,s.Vs)(o("checkWifiConnection").catch(()=>!1),a.Z.NETWORK_TIMEOUT);return e},x=()=>o("getIpAddress").catch(()=>""),g=()=>c("network_list"),w=async()=>{let e=await o("getTemperatureHumidity").catch(()=>({temperature:"---",humidity:"---"}));return e},p=async()=>{let e=await o("getWifiInfo").catch(()=>({ssid:"error",quality:0})),t=Math.round(Number.parseInt(e.quality,10)/70*100);return{ssid:e.ssid,quality:t}},v=async()=>{let e=await o("getWifiNetworks").catch(()=>""),t=e.split("ESSID:").map(e=>e.trim().replace(/^"|"$/g,"")).filter((e,t,r)=>r.indexOf(e)===t).filter(e=>e);return t},y=async e=>{console.log("setDevicePower> Setting device power to ".concat(e)),await (0,n.JG)("/device-power",e),e?console.log(await d()):console.log(await u())},j=async(e,t)=>{let r=await o("setWifiNetwork",{ssid:e,password:t});return r},b=async(e,t)=>{let r=await c("network_list"),n="object"==typeof r?await l("network_list",{...r,[e]:t}):await l("network_list",{[e]:t});return n}},8893:function(e,t,r){"use strict";var n=r(5752),a=r(7478);let s=async function(e){for(var t,r,s=arguments.length,i=Array(s>1?s-1:0),o=1;o<s;o++)i[o-1]=arguments[o];(null===(r=window.pywebview)||void 0===r?void 0:null===(t=r.api)||void 0===t?void 0:t.log)?(console.log("[Pylog] ".concat(e),...i),await (0,a.Vs)((async()=>(await window.pywebview.api.log(e),!0))(),n.Z.TIMEOUT).catch(t=>console.log("[Pylog] ".concat(e," error: ").concat(t)))):console.log("[Pylog Error] ".concat(e),...i)};t.Z=s},2543:function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return W}});var n=r(5893),a=r(7294),s=r(2182),i=r(5894),o=r(1598),c=r(4724),l=r(3998),d=r(8949),u=r(9858),f=r(7246),h=r(6309),m=r(1664),x=r.n(m),g=r(802),w=r(7537);let p=a.forwardRef((e,t)=>{let{className:r,...a}=e;return(0,n.jsx)("div",{ref:t,className:(0,w.cn)("rounded-xl border bg-card text-card-foreground shadow",r),...a})});p.displayName="Card";let v=a.forwardRef((e,t)=>{let{className:r,...a}=e;return(0,n.jsx)("div",{ref:t,className:(0,w.cn)("flex flex-col space-y-1.5 p-6",r),...a})});v.displayName="CardHeader";let y=a.forwardRef((e,t)=>{let{className:r,...a}=e;return(0,n.jsx)("h3",{ref:t,className:(0,w.cn)("font-semibold leading-none tracking-tight",r),...a})});y.displayName="CardTitle";let j=a.forwardRef((e,t)=>{let{className:r,...a}=e;return(0,n.jsx)("p",{ref:t,className:(0,w.cn)("text-sm text-muted-foreground",r),...a})});j.displayName="CardDescription";let b=a.forwardRef((e,t)=>{let{className:r,...a}=e;return(0,n.jsx)("div",{ref:t,className:(0,w.cn)("p-6 pt-0",r),...a})});b.displayName="CardContent";let N=a.forwardRef((e,t)=>{let{className:r,...a}=e;return(0,n.jsx)("div",{ref:t,className:(0,w.cn)("flex items-center p-6 pt-0",r),...a})});N.displayName="CardFooter";var E=r(2780);let O=a.forwardRef((e,t)=>{let{className:r,orientation:a="horizontal",decorative:s=!0,...i}=e;return(0,n.jsx)(E.f,{ref:t,decorative:s,orientation:a,className:(0,w.cn)("shrink-0 bg-border","horizontal"===a?"h-[1px] w-full":"h-full w-[1px]",r),...i})});O.displayName=E.f.displayName;var R=r(1093);let Z=a.forwardRef((e,t)=>{let{className:r,...a}=e;return(0,n.jsx)(R.fC,{className:(0,w.cn)("peer inline-flex h-5 w-9 shrink-0 cursor-pointer items-center rounded-full border-2 border-transparent shadow-sm transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 focus-visible:ring-offset-background disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=unchecked]:bg-input",r),...a,ref:t,children:(0,n.jsx)(R.bU,{className:(0,w.cn)("pointer-events-none block h-4 w-4 rounded-full bg-background shadow-lg ring-0 transition-transform data-[state=checked]:translate-x-4 data-[state=unchecked]:translate-x-0")})})});Z.displayName=R.fC.displayName;let _=e=>{let t=parseFloat(e.toString());return 9*t/5+32};var k=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return Math.trunc(e*Math.pow(10,t))/Math.pow(10,t)},T=r(4334),P=r(9734),I=r(1473),S=r(5752),C=e=>{let{data:t,error:r,mutate:n}=(0,P.ZP)("/device-power-status",I.uT,{refreshInterval:S.Z.RETRY_DELAY,refreshWhenHidden:!1,refreshWhenOffline:!0,revalidateIfStale:!0,revalidateOnFocus:!0,revalidateOnReconnect:!0,...e});return console.log("useDevicePowerStatus> ",t,r),{mutate:n,status:"on"===t,isLoading:!r&&void 0===t,isError:r}},F=e=>{let{data:t,error:r}=(0,P.ZP)("/ip-address",I.I_,{refreshInterval:S.Z.NETWORK_TIMEOUT,refreshWhenHidden:!0,refreshWhenOffline:!0,revalidateIfStale:!0,revalidateOnFocus:!0,revalidateOnReconnect:!0,...e});return{ip:t,isLoading:!r&&!t,isError:r}},z=e=>{let{data:t,error:r}=(0,P.ZP)("/temperature-humidity",I.sc,{refreshInterval:S.Z.RETRY_DELAY,refreshWhenHidden:!0,refreshWhenOffline:!0,revalidateIfStale:!0,revalidateOnFocus:!0,revalidateOnReconnect:!0,...e});return{data:t,isLoading:!r&&!t,isError:r}},W=()=>{let{data:e}=z(),{hwid:t}=(0,T.Z)(),{ip:r}=F(),{status:m}=C();console.log("status",typeof m);let N=async()=>{(0,I.b)(!m)},E=(0,a.useMemo)(()=>(null==e?void 0:e.temperature)?k(_(e.temperature),2):"---",[null==e?void 0:e.temperature]);return(0,n.jsx)(n.Fragment,{children:(0,n.jsxs)("div",{className:" flex h-full flex-col justify-between",children:[(0,n.jsxs)(v,{children:[(0,n.jsxs)(y,{children:[(0,n.jsx)(u.Z,{})," Device Power"]}),(0,n.jsx)(j,{children:"Controlling device power status"})]}),(0,n.jsxs)("div",{className:"grid grid-cols-3 gap-2",children:[(0,n.jsx)(n.Fragment,{children:(0,n.jsxs)(p,{children:[(0,n.jsxs)(v,{className:"flex flex-row items-center justify-between space-x-2 space-y-0 pb-2",children:[(0,n.jsx)(y,{className:"text-sm font-medium",children:"Temperature"}),(0,n.jsx)(s.Z,{})]}),(0,n.jsxs)(b,{children:[(0,n.jsxs)("div",{className:"text-2xl font-bold",children:[null==e?void 0:e.temperature," \xb0C"]}),(0,n.jsxs)("p",{className:"text-muted-foreground",children:[E," \xb0F"]})]})]})}),(0,n.jsxs)(p,{onClick:N,className:"cursor-pointer",children:[(0,n.jsxs)(v,{className:"flex flex-row items-center justify-center space-x-2 space-y-0 pb-2",children:[(0,n.jsx)(y,{className:"text-sm font-bold",children:m?"On":"Off"}),m?(0,n.jsx)(f.Z,{size:12}):(0,n.jsx)(h.Z,{size:12})]}),(0,n.jsx)(b,{className:"flex flex-col items-center justify-center gap-2",children:(0,n.jsx)(Z,{checked:m})})]}),(0,n.jsx)(n.Fragment,{children:(0,n.jsxs)(p,{children:[(0,n.jsxs)(v,{className:"flex flex-row items-center justify-between space-x-2 space-y-0 pb-2",children:[(0,n.jsx)(y,{className:"text-sm font-medium",children:"Humidity"}),(0,n.jsx)(i.Z,{})]}),(0,n.jsx)(b,{children:(0,n.jsxs)("div",{className:"text-2xl font-bold",children:[null==e?void 0:e.humidity,"%"]})})]})})]}),(0,n.jsxs)("div",{children:[(0,n.jsx)(O,{className:"my-2"}),(0,n.jsxs)("div",{className:"grid grid-cols-3 text-xs",children:[(0,n.jsxs)("div",{className:"flex items-center gap-2",children:[(0,n.jsx)(o.Z,{fontSize:"small"}),t||"unknown"]}),(0,n.jsx)(x(),{href:"/settings/view-qr",className:(0,w.cn)((0,g.d)({variant:"ghost"}),"w-full flex justify-center"),children:(0,n.jsx)(c.Z,{fontSize:"large"})}),(0,n.jsx)(x(),{href:"/wifi",className:(0,w.cn)((0,g.d)({variant:"ghost"}),"flex gap-2 items-center justify-end text-xs"),children:r?(0,n.jsxs)(n.Fragment,{children:[r,(0,n.jsx)(l.Z,{fontSize:"small"})]}):(0,n.jsxs)(n.Fragment,{children:["Disconnected",(0,n.jsx)(d.Z,{fontSize:"small"})]})})]})]})]})})}},7478:function(e,t,r){"use strict";r.d(t,{H_:function(){return s},Vs:function(){return n}});let n=(e,t)=>{let r;return Promise.race([e,new Promise((e,n)=>r=setTimeout(()=>n(Error("timeout")),t))]).finally(()=>clearTimeout(r))},a=e=>new Promise(t=>setTimeout(t,e)),s=(e,t,r)=>new Promise((n,i)=>e().then(n).catch(o=>r>0?a(t).then(s.bind(null,e,t,r-1)).then(n).catch(e=>{let t="Operation failed";e instanceof Error&&(t=e.message),i(t)}):i(o)))}},function(e){e.O(0,[664,734,646,913,774,888,179],function(){return e(e.s=528)}),_N_E=e.O()}]);