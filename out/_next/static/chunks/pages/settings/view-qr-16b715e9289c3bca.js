(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[681],{6286:function(t,e,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/settings/view-qr",function(){return n(7223)}])},7793:function(t,e,n){"use strict";var r=n(5893),o=n(7294),a=n(2592),c=n(8893);e.Z=t=>{let{data:e}=t,n=(0,o.useRef)(null);return(0,o.useEffect)(()=>{e&&"undefined"!==e&&a.toCanvas(n.current,e,async t=>{var n,r;t&&await (null===(r=window.pywebview)||void 0===r?void 0:null===(n=r.api)||void 0===n?void 0:n.log(t)),await (0,c.Z)("Created QR: ".concat(e))})},[e]),(0,r.jsx)("canvas",{ref:n})}},4334:function(t,e,n){"use strict";var r=n(9734),o=n(1473);e.Z=t=>{let{data:e,error:n}=(0,r.ZP)("/hardware-id",o.Od,{revalidateIfStale:!1,revalidateOnFocus:!1,revalidateOnReconnect:!1,...t});return{hwid:e,isLoading:!n&&!e,isError:n}}},1473:function(t,e,n){"use strict";n.d(e,{uT:function(){return w},Od:function(){return f},I_:function(){return v},GI:function(){return h},M7:function(){return y},sc:function(){return g},wl:function(){return p},Sj:function(){return m},b:function(){return E},Hu:function(){return P},Cz:function(){return _}});var r=n(9734),o=n(8893),a=n(5752),c=n(7478),i=function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:void 0;return(0,c.H_)(async()=>{try{var n,r;if(!(null===(r=window.pywebview)||void 0===r?void 0:null===(n=r.api)||void 0===n?void 0:n[t]))throw Error("API endpoint not found");await (0,o.Z)("PyCall ".concat(t),e);let a=await window.pywebview.api[t](e).then(t=>JSON.parse(t)).then(async e=>{if(null==e?void 0:e.error)throw e.error;if(void 0===e.message)throw Error("Response message was empty ".concat(e));return await (0,o.Z)("Pycall ".concat(t," returned: ").concat(e.message),e),e.message});return a}catch(n){let e="".concat(n);throw n instanceof Error&&(e=n.message),await (0,o.Z)("Pycall ".concat(t," (retrying): ").concat(e)),Error(e)}},a.Z.RETRY_DELAY,a.Z.MAX_RETRIES).catch(async e=>{let n="".concat(t," - ").concat(e);throw e instanceof Error&&(n=e.message),await (0,o.Z)("Pycall ".concat(t," - FATAL ERROR: ").concat(n)),Error(n)})};let s=t=>i("get",{key:t}).then(t=>{console.log("Got: ",t);try{return JSON.parse(t)}catch(e){return t}}).catch(t=>(console.log("pyget error: ".concat(t)),"")),l=(t,e)=>(console.log("Setting: ".concat(t,", ").concat(e)),i("set",{key:t,data:e}).catch(t=>(console.log("Pyset error: ",t),""))),u=()=>i("deviceOn").catch(()=>"error"),d=()=>i("deviceOff").catch(()=>"error"),w=()=>i("getDeviceStatus").catch(()=>"error"),f=()=>i("getHardwareId").catch(()=>""),h=async()=>{let t=await (0,c.Vs)(i("checkWifiConnection").catch(()=>!1),a.Z.NETWORK_TIMEOUT);return t},v=()=>i("getIpAddress").catch(()=>""),y=()=>s("network_list"),g=async()=>{let t=await i("getTemperatureHumidity").catch(()=>({temperature:"---",humidity:"---"}));return t},p=async()=>{let t=await i("getWifiInfo").catch(()=>({ssid:"error",quality:0})),e=Math.round(Number.parseInt(t.quality,10)/70*100);return{ssid:t.ssid,quality:e}},m=async()=>{let t=await i("getWifiNetworks").catch(()=>""),e=t.split("ESSID:").map(t=>t.trim().replace(/^"|"$/g,"")).filter((t,e,n)=>n.indexOf(t)===e).filter(t=>t);return e},E=async t=>{console.log("setDevicePower> Setting device power to ".concat(t)),await (0,r.JG)("/device-power",t),t?console.log(await u()):console.log(await d())},_=async(t,e)=>{let n=await i("setWifiNetwork",{ssid:t,password:e});return n},P=async(t,e)=>{let n=await s("network_list"),r="object"==typeof n?await l("network_list",{...n,[t]:e}):await l("network_list",{[t]:e});return r}},8893:function(t,e,n){"use strict";var r=n(5752),o=n(7478);let a=async function(t){for(var e,n,a=arguments.length,c=Array(a>1?a-1:0),i=1;i<a;i++)c[i-1]=arguments[i];(null===(n=window.pywebview)||void 0===n?void 0:null===(e=n.api)||void 0===e?void 0:e.log)?(console.log("[Pylog] ".concat(t),...c),await (0,o.Vs)((async()=>(await window.pywebview.api.log(t),!0))(),r.Z.TIMEOUT).catch(e=>console.log("[Pylog] ".concat(t," error: ").concat(e)))):console.log("[Pylog Error] ".concat(t),...c)};e.Z=a},7223:function(t,e,n){"use strict";n.r(e);var r=n(5893),o=n(1664),a=n.n(o),c=n(7793),i=n(4334);e.default=()=>{let{hwid:t}=(0,i.Z)();return(0,r.jsx)(r.Fragment,{children:(0,r.jsxs)("div",{className:"flex flex-col",children:[(0,r.jsx)("h4",{className:"my-0",children:"Control your device"}),(0,r.jsx)("p",{children:"Scan the QR code with your phone or laptop to control your device from anywhere."}),(0,r.jsx)(c.Z,{data:t}),(0,r.jsx)(a(),{href:"/dashboard",passHref:!0,children:"Back"})]})})}},7478:function(t,e,n){"use strict";n.d(e,{H_:function(){return a},Vs:function(){return r}});let r=(t,e)=>{let n;return Promise.race([t,new Promise((t,r)=>n=setTimeout(()=>r(Error("timeout")),e))]).finally(()=>clearTimeout(n))},o=t=>new Promise(e=>setTimeout(e,t)),a=(t,e,n)=>new Promise((r,c)=>t().then(r).catch(i=>n>0?o(e).then(a.bind(null,t,e,n-1)).then(r).catch(t=>{let e="Operation failed";t instanceof Error&&(e=t.message),c(e)}):c(i)))}},function(t){t.O(0,[664,734,592,774,888,179],function(){return t(t.s=6286)}),_N_E=t.O()}]);